<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #f0f8ff;
            text-align: center;
            padding: 40px;
        }

        h1 {
            color: #0056b3;
        }

        .controls {
            margin: 30px auto;
            width: 300px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr 1fr;
            gap: 10px;
        }

        button {
            padding: 15px;
            font-size: 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s;
        }

        .forward {
            background: #4CAF50;
            color: white;
        }

        .backward {
            background: #f44336;
            color: white;
        }

        .left {
            background: #2196F3;
            color: white;
        }

        .right {
            background: #FF9800;
            color: white;
        }

        .stop {
            background: #9c27b0;
            color: white;
        }

        button:hover {
            transform: scale(1.05);
        }

        .status {
            margin-top: 20px;
            font-size: 18px;
            color: #555;
        }
    </style>
</head>

<body>

    <h1>ğŸš— Ø±ÙˆØ¨ÙˆØª Ø§Ù„Ø³ÙŠØ§Ø±Ø© - Ø§Ù„ØªØ­ÙƒÙ… Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­</h1>

    <div class="controls">
        <button class="forward" onclick="sendCommand('F')">Ø£Ù…Ø§Ù…</button>
        <button class="left" onclick="sendCommand('L')">ÙŠØ³Ø§Ø±</button>
        <button class="right" onclick="sendCommand('R')">ÙŠÙ…ÙŠÙ†</button>
        <button class="backward" onclick="sendCommand('B')">Ø®Ù„Ù</button>
        <button class="stop" onclick="sendCommand('S')">ØªÙˆÙ‚Ù‘Ù</button>
    </div>

    <p class="status" id="status">Ø§Ù†ØªØ¸Ø± Ø§Ù„Ø§ØªØµØ§Ù„...</p>

    <script>
        let bluetoothDevice = null;
        let bluetoothCharacteristic = null;

        async function connect() {
            try {
                const device = await navigator.bluetooth.requestDevice({
                    filters: [{ name: "RobotCar_Web" }]
                });

                document.getElementById("status").textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...";

                const server = await device.gatt.connect();
                const service = await server.getPrimaryService("6E400001-B5A3-F393-E0A9-E50E24DCCA9E");
                bluetoothCharacteristic = await service.getCharacteristic("6E400002-B5A3-F393-E0A9-E50E24DCCA9E");

                bluetoothDevice = device;
                document.getElementById("status").textContent = "ØªÙ… Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­!";
                console.log("Connected to RobotCar_Web");
            } catch (error) {
                console.error("Connection failed:", error);
                alert("ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„: " + error.message);
            }
        }

        async function sendCommand(command) {
            if (!bluetoothCharacteristic) {
                alert("Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø§ØªØµØ§Ù„. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ 'Ø§ØªØµØ§Ù„' Ø£ÙˆÙ„Ù‹Ø§.");
                return;
            }

            try {
                await bluetoothCharacteristic.writeValue(new TextEncoder().encode(command));
                console.log("Command sent:", command);
            } catch (error) {
                console.error("Failed to send command:", error);
                alert("ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + error.message);
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø±
        window.onload = () => {
            const connectBtn = document.createElement("button");
            connectBtn.textContent = "Ø§ØªØµØ§Ù„";
            connectBtn.style.fontSize = "18px";
            connectBtn.style.padding = "10px 20px";
            connectBtn.style.margin = "10px auto";
            connectBtn.onclick = connect;
            document.body.appendChild(connectBtn);
        };
    </script>

</body>

</html>